
{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<style>
    /* Hero Carousel Styles */
    .hero-carousel {
        position: relative;
        height: 600px;
        overflow: hidden;
        border-radius: 15px;
        margin-bottom: 40px;
    }
    .hero-slide {
        position: relative;
        height: 600px;
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .hero-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(30,58,138,0.85) 0%, rgba(59,130,246,0.85) 100%);
    }
    .hero-content {
        position: relative;
        z-index: 2;
        color: white;
        text-align: center;
        padding: 40px;
        max-width: 900px;
    }
    .hero-content h1 {
        font-size: 3.5rem;
        font-weight: bold;
        margin-bottom: 20px;
    }
    .hero-content p {
        font-size: 1.5rem;
        margin-bottom: 20px;
    }

    /* Stats Section */
    .stats-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 60px 0;
        margin: 40px 0;
        border-radius: 15px;
        color: white;
    }
    .stat-card {
        text-align: center;
        padding: 25px;
        border-radius: 12px;
        transition: transform 0.3s;
    }
    .stat-card:hover {
        transform: translateY(-10px);
    }
    .stat-icon {
        font-size: 3.5rem;
    }
    .stat-value {
        font-size: 2.5rem;
        font-weight: bold;
    }

    /* Ticker */
    .sales-ticker {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        padding: 20px;
        border-radius: 12px;
        color: white;
    }
    .ticker-item {
        display: flex;
        align-items: center;
        padding: 12px;
        background: rgba(255,255,255,0.15);
        border-radius: 8px;
        margin-bottom: 8px;
    }

    /* Content Section */
    .content-section {
        background: white;
        padding: 50px 30px;
        border-radius: 15px;
        margin: 40px 0;
        box-shadow: 0px 8px 30px rgba(0,0,0,0.15);
    }

    /* Teams */
    .team-card {
        transition: transform .2s, box-shadow .2s;
    }
    .team-card:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .team-logo-container {
        height: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        background: #e5e7eb;
        margin-bottom: 10px;
    }

    /* How it works */
    .how-it-works {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        padding: 60px 30px;
        border-radius: 15px;
        color: white;
        margin-top: 50px;
    }
    .step-card {
        text-align: center;
        padding: 20px 10px;
    }

    /* Responsive */
    @media(max-width: 768px) {
        .hero-carousel, .hero-slide { height: 350px; }
        .hero-content h1 { font-size: 1.9rem; }
        .hero-content p { font-size: 1.1rem; }
        .stat-card { padding: 15px; }
        .stat-value { font-size: 1.8rem; }
        .sales-ticker { padding: 15px; }
    }
    .sepl-btn {
    border-radius: 10px;
    font-size: 1.1rem;
    transition: all .25s ease;
}

.sepl-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 18px rgba(0,0,0,0.25);
}

/* Responsive Buttons on Mobile */
@media (max-width: 576px) {
    .sepl-btn {
        display: block;
        width: 100%;
        text-align: center;
        font-size: 1rem;
        padding: 12px 18px;
    }
}

/* Rotating Circle Carousel */
.circle-carousel-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 350px;
    position: relative;
    margin-bottom: 60px;
}

.circle-carousel {
    width: 420px;
    height: 420px;
    position: relative;
    border-radius: 50%;
    animation: circleRotate 20s linear infinite;
    transform-style: preserve-3d;
}

.circle-item {
    width: 140px;
    height: 90px;
    position: absolute;
    left: 50%;
    top: 50%;
    transform-style: preserve-3d;
}

.circle-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.35);
    background: white;
    border: 3px solid #ffffff;
}

@keyframes circleRotate {
    from { transform: rotateZ(0deg); }
    to { transform: rotateZ(360deg); }
}

/* Mobile Responsive */
@media (max-width: 576px) {
    .circle-carousel {
        width: 300px;
        height: 300px;
    }
    .circle-item {
        width: 110px;
        height: 70px;
    }
}


</style>
{% endblock %}

{% block content %}

<!-- HERO CAROUSEL -->
{% if hero_banners %}
<div id="heroCarousel" class="carousel slide hero-carousel" data-bs-ride="carousel">
    <div class="carousel-indicators">
        {% for banner in hero_banners %}
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
                class="{% if forloop.first %}active{% endif %}"></button>
        {% endfor %}
    </div>

    <div class="carousel-inner">
        {% for banner in hero_banners %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <div class="hero-slide" style="background-image:url('{{ banner.image.url }}')">
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <h1><i class="bi bi-trophy-fill text-warning"></i> {{ banner.heading|default:"SATPUDA ENGINEERING PREMIER LEAGUE" }}</h1>
                    <p>{{ banner.subheading|default:"The Ultimate Cricket Experience" }}</p>

                    {% if active_session %}
                    <div class="alert alert-warning live-auction-alert mt-3 fw-bold">
                        <i class="bi bi-broadcast-pin"></i> LIVE AUCTION IN PROGRESS
                    </div>
                    {% endif %}

                    <div class="d-flex flex-wrap gap-3 justify-content-center mt-4">
                        {% if not user.is_authenticated %}
                        <a href="{% url 'register' %}" class="btn btn-warning fw-bold px-4 py-2 shadow-lg sepl-btn">
                            <i class="bi bi-person-plus"></i> Register
                        </a>
                        <a href="{% url 'login' %}" class="btn btn-light fw-bold px-4 py-2 shadow-lg sepl-btn">
                            <i class="bi bi-box-arrow-in-right"></i> Login
                        </a>
                        {% else %}
                        <a href="{% url 'dashboard' %}"  class="btn btn-warning fw-bold px-4 py-2 shadow-lg sepl-btn">>
                            <i class="bi bi-speedometer2"></i> Dashboard
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- SECONDARY BANNERS POPUP MODAL -->
{% if secondary_banners %}
<div class="modal fade" id="promoModal" tabindex="-1" aria-labelledby="promoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content" style="border-radius:15px; overflow:hidden;">
      
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="promoModalLabel">
          ðŸŒŸ Announcements & Updates
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body p-0">
        <div id="promoCarousel" class="carousel slide" data-bs-ride="carousel">
          <div class="carousel-inner">
            {% for banner in secondary_banners %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <img src="{{ banner.image.url }}" class="d-block w-100" style="max-height:450px; object-fit:cover;">
              <div class="p-3 bg-dark text-white">
                <h5>{{ banner.heading }}</h5>
                <p>{{ banner.description|default:"" }}</p>
                {% if banner.button_link %}
                <a href="{{ banner.button_link }}" class="btn btn-warning btn-sm mt-2">
                    {{ banner.button_text|default:"Learn More" }}
                </a>
                {% endif %}
              </div>
            </div>
            {% endfor %}
          </div>

          <button class="carousel-control-prev" type="button" data-bs-target="#promoCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#promoCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
          </button>

        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}





<!-- STATS -->
<div class="stats-section container text-center">
    <h2 class="mb-5 text-white fw-bold"><i class="bi bi-bar-chart"></i> Tournament Overview</h2>
    <div class="row g-3">
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-people-fill"></i></div>
                <div class="stat-value">{{ teams.count }}</div>
                <div class="stat-label">Teams</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-person-badge-fill"></i></div>
                <div class="stat-value">{{ total_players }}</div>
                <div class="stat-label">Players</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-cash-stack"></i></div>
                <div class="stat-value">â‚¹10,000</div>
                <div class="stat-label">Base Purse</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-trophy-fill"></i></div>
                <div class="stat-value">{{ active_session|yesno:"LIVE,OFF" }}</div>
                <div class="stat-label">Auction</div>
            </div>
        </div>
    </div>
</div>

<!-- RECENT SALES -->
{% if recent_sales %}
<div class="container">
    <div class="sales-ticker">
        <h3 class="fw-bold"><i class="bi bi-fire"></i> Recent Sales</h3>
        {% for log in recent_sales %}
        <div class="ticker-item">
            <div><b>{{ log.player.user.get_full_name }}</b> â†’ <span>{{ log.winning_team.name }}</span></div>
            <div class="ms-auto"><span class="badge bg-light text-dark fs-6">â‚¹{{ log.final_amount }}</span></div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- TEAMS -->
{% if teams %}
<div class="container">
    <div class="content-section text-center">
        <h2 class="fw-bold mb-4"><i class="bi bi-shield-fill-check"></i> Participating Teams</h2>
        <div class="row g-4">
            {% for team in teams %}
            <div class="col-sm-6 col-md-4 col-lg-3">
                <div class="card team-card h-100 p-2">
                    <div class="team-logo-container">
                        {% if team.logo %}
                        <img src="{{ team.logo.url }}" class="img-fluid" style="max-height: 100px;">
                        {% else %}
                        <i class="bi bi-shield-fill text-primary" style="font-size:4rem"></i>
                        {% endif %}
                    </div>
                    <h5 class="mt-2">{{ team.name }}</h5>
                    <small class="text-muted"><i class="bi bi-people"></i> {{ team.players.count }} Players</small><br>
                    <small class="text-muted"><i class="bi bi-wallet2"></i> â‚¹{{ team.purse_remaining }} left</small>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

<!-- HOW IT WORKS -->
<div class="container">
    <div class="how-it-works text-center">
        <h2 class="fw-bold mb-4"><i class="bi bi-lightbulb"></i> How It Works</h2>
        <div class="row text-center">
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-person-plus-fill step-icon"></i>
                <h5>1. Register</h5>
                <p>Join as Player / Owner / Manager</p>
            </div>
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-check-circle-fill step-icon"></i>
                <h5>2. Approval</h5>
                <p>Admin verifies profiles</p>
            </div>
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-hammer step-icon"></i>
                <h5>3. Auction</h5>
                <p>Real-time live bidding</p>
            </div>
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-trophy-fill step-icon"></i>
                <h5>4. Compete</h5>
                <p>Play the Tournament</p>
            </div>
        </div>
    </div>
</div>

{% if footer_banners %}
<h3 class="text-center fw-bold mt-5 mb-4">
    ðŸŒŸ Teams ðŸŒŸ
</h3>

<div class="circle-carousel-container">
    <div class="circle-carousel">
        {% for banner in footer_banners %}
        <div class="circle-item">
            <img src="{{ banner.image.url }}" alt="Sponsor">
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const carousel = document.querySelector('#heroCarousel');
        if (carousel) {
            new bootstrap.Carousel(carousel, { interval: 5000, ride: 'carousel' });
        }
    });
    document.addEventListener("DOMContentLoaded", function () {
    const modalShown = sessionStorage.getItem("promo_shown");
    const promoModal = document.getElementById("promoModal");

    if (promoModal && !modalShown) {
        const modal = new bootstrap.Modal(promoModal);
        modal.show();
        sessionStorage.setItem("promo_shown", "true");
    }
});
document.addEventListener("DOMContentLoaded", () => {
    const items = document.querySelectorAll(".circle-item");
    const angleStep = 360 / items.length;

    items.forEach((item, index) => {
        const angle = angleStep * index;
        const radius = 160;  // Distance from center
        const x = radius * Math.cos(angle * Math.PI / 180);
        const y = radius * Math.sin(angle * Math.PI / 180);

        item.style.transform = `translate(${x}px, ${y}px)`;
    });
});
</script>
{% endblock %}

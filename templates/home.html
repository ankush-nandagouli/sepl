<!-- templates/home.html -->
{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<style>
    /* Hero Carousel Styles */
    .hero-carousel {
        position: relative;
        height: 600px;
        overflow: hidden;
        border-radius: 15px;
        margin-bottom: 40px;
    }
    .hero-slide {
        position: relative;
        height: 600px;
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .hero-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(30,58,138,0.85) 0%, rgba(59,130,246,0.85) 100%);
    }
    .hero-content {
        position: relative;
        z-index: 2;
        color: white;
        text-align: center;
        padding: 40px;
        max-width: 900px;
    }
    .hero-content h1 {
        font-size: 3.5rem;
        font-weight: bold;
        margin-bottom: 20px;
    }
    .hero-content p {
        font-size: 1.5rem;
        margin-bottom: 20px;
    }

    /* Stats Section */
    .stats-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 60px 0;
        margin: 40px 0;
        border-radius: 15px;
        color: white;
    }
    .stat-card {
        text-align: center;
        padding: 25px;
        border-radius: 12px;
        transition: transform 0.3s;
    }
    .stat-card:hover {
        transform: translateY(-10px);
    }
    .stat-icon {
        font-size: 3.5rem;
    }
    .stat-value {
        font-size: 2.5rem;
        font-weight: bold;
    }

    /* Ticker */
    .sales-ticker {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        padding: 20px;
        border-radius: 12px;
        color: white;
    }
    .ticker-item {
        display: flex;
        align-items: center;
        padding: 12px;
        background: rgba(255,255,255,0.15);
        border-radius: 8px;
        margin-bottom: 8px;
    }

    /* Content Section */
    .content-section {
        background: white;
        padding: 50px 30px;
        border-radius: 15px;
        margin: 40px 0;
        box-shadow: 0px 8px 30px rgba(0,0,0,0.15);
    }

    /* Teams */
    .team-card {
        transition: transform .2s, box-shadow .2s;
    }
    .team-card:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .team-logo-container {
        height: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        background: #e5e7eb;
        margin-bottom: 10px;
    }

    /* How it works */
    .how-it-works {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        padding: 60px 30px;
        border-radius: 15px;
        color: white;
        margin-top: 50px;
    }
    .step-card {
        text-align: center;
        padding: 20px 10px;
    }

    /* Responsive */
    @media(max-width: 768px) {
        .hero-carousel, .hero-slide { height: 350px; }
        .hero-content h1 { font-size: 1.9rem; }
        .hero-content p { font-size: 1.1rem; }
        .stat-card { padding: 15px; }
        .stat-value { font-size: 1.8rem; }
        .sales-ticker { padding: 15px; }
    }
</style>
{% endblock %}

{% block content %}

<!-- HERO CAROUSEL -->
{% if hero_banners %}
<div id="heroCarousel" class="carousel slide hero-carousel" data-bs-ride="carousel">
    <div class="carousel-indicators">
        {% for banner in hero_banners %}
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
                class="{% if forloop.first %}active{% endif %}"></button>
        {% endfor %}
    </div>

    <div class="carousel-inner">
        {% for banner in hero_banners %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <div class="hero-slide" style="background-image:url('{{ banner.image.url }}')">
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <h1><i class="bi bi-trophy-fill text-warning"></i> {{ banner.heading|default:"SATPUDA ENGINEERING PREMIER LEAGUE" }}</h1>
                    <p>{{ banner.subheading|default:"The Ultimate Cricket Experience" }}</p>

                    {% if active_session %}
                    <div class="alert alert-warning live-auction-alert mt-3 fw-bold">
                        <i class="bi bi-broadcast-pin"></i> LIVE AUCTION IN PROGRESS
                    </div>
                    {% endif %}

                    <div class="mt-4">
                        {% if not user.is_authenticated %}
                        <a href="{% url 'register' %}" class="btn btn-warning btn-lg me-2 px-4 py-2">
                            <i class="bi bi-person-plus"></i> Register
                        </a>
                        <a href="{% url 'login' %}" class="btn btn-light btn-lg px-4 py-2">
                            <i class="bi bi-box-arrow-in-right"></i> Login
                        </a>
                        {% else %}
                        <a href="{% url 'dashboard' %}" class="btn btn-warning btn-lg px-4 py-2">
                            <i class="bi bi-speedometer2"></i> Dashboard
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}


<!-- PROMO SECTION -->
<div class="container my-5">
    <div class="content-section text-center" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); color:white;">
        <h2 class="fw-bold display-5">
            ðŸŒŸ Satpuda Engineering Premier League â€“ Join Now!
        </h2>
        <p class="lead mt-3">
            Be a part of the most exciting cricket battle of Satpuda. Register today and take your first step to glory!
        </p>

        <div class="mt-4">
            {% if not user.is_authenticated %}
            <a href="{% url 'register' %}" class="btn btn-warning btn-lg me-3 px-4 py-2 shadow">
                <i class="bi bi-person-plus-fill"></i> Register
            </a>
            <a href="{% url 'login' %}" class="btn btn-light btn-lg px-4 py-2 shadow">
                <i class="bi bi-box-arrow-in-right"></i> Login
            </a>
            {% else %}
            <a href="{% url 'dashboard' %}" class="btn btn-warning btn-lg px-4 py-2 shadow">
                <i class="bi bi-speedometer2"></i> Go to Dashboard
            </a>
            {% endif %}
        </div>
    </div>
</div>


<!-- STATS -->
<div class="stats-section container text-center">
    <h2 class="mb-5 text-white fw-bold"><i class="bi bi-bar-chart"></i> Tournament Overview</h2>
    <div class="row g-3">
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-people-fill"></i></div>
                <div class="stat-value">{{ teams.count }}</div>
                <div class="stat-label">Teams</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-person-badge-fill"></i></div>
                <div class="stat-value">{{ total_players }}</div>
                <div class="stat-label">Players</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-cash-stack"></i></div>
                <div class="stat-value">â‚¹10,000</div>
                <div class="stat-label">Base Purse</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon"><i class="bi bi-trophy-fill"></i></div>
                <div class="stat-value">{{ active_session|yesno:"LIVE,OFF" }}</div>
                <div class="stat-label">Auction</div>
            </div>
        </div>
    </div>
</div>

<!-- RECENT SALES -->
{% if recent_sales %}
<div class="container">
    <div class="sales-ticker">
        <h3 class="fw-bold"><i class="bi bi-fire"></i> Recent Sales</h3>
        {% for log in recent_sales %}
        <div class="ticker-item">
            <div><b>{{ log.player.user.get_full_name }}</b> â†’ <span>{{ log.winning_team.name }}</span></div>
            <div class="ms-auto"><span class="badge bg-light text-dark fs-6">â‚¹{{ log.final_amount }}</span></div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- TEAMS -->
{% if teams %}
<div class="container">
    <div class="content-section text-center">
        <h2 class="fw-bold mb-4"><i class="bi bi-shield-fill-check"></i> Participating Teams</h2>
        <div class="row g-4">
            {% for team in teams %}
            <div class="col-sm-6 col-md-4 col-lg-3">
                <div class="card team-card h-100 p-2">
                    <div class="team-logo-container">
                        {% if team.logo %}
                        <img src="{{ team.logo.url }}" class="img-fluid" style="max-height: 100px;">
                        {% else %}
                        <i class="bi bi-shield-fill text-primary" style="font-size:4rem"></i>
                        {% endif %}
                    </div>
                    <h5 class="mt-2">{{ team.name }}</h5>
                    <small class="text-muted"><i class="bi bi-people"></i> {{ team.players.count }} Players</small><br>
                    <small class="text-muted"><i class="bi bi-wallet2"></i> â‚¹{{ team.purse_remaining }} left</small>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

<!-- HOW IT WORKS -->
<div class="container">
    <div class="how-it-works text-center">
        <h2 class="fw-bold mb-4"><i class="bi bi-lightbulb"></i> How It Works</h2>
        <div class="row text-center">
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-person-plus-fill step-icon"></i>
                <h5>1. Register</h5>
                <p>Join as Player / Owner / Manager</p>
            </div>
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-check-circle-fill step-icon"></i>
                <h5>2. Approval</h5>
                <p>Admin verifies profiles</p>
            </div>
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-hammer step-icon"></i>
                <h5>3. Auction</h5>
                <p>Real-time live bidding</p>
            </div>
            <div class="col-6 col-md-3 step-card">
                <i class="bi bi-trophy-fill step-icon"></i>
                <h5>4. Compete</h5>
                <p>Play the Tournament</p>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const carousel = document.querySelector('#heroCarousel');
        if (carousel) {
            new bootstrap.Carousel(carousel, { interval: 5000, ride: 'carousel' });
        }
    });
</script>
{% endblock %}
